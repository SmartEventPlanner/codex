<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>スマートイベントプランナー</title>
<style>
  /* ... (前回のCSSから変更なし) ... */
  :root { --header-height: 64px; --sidebar-width: 250px; }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body { height: 100%; font-family: 'Segoe UI', 'Helvetica Neue', sans-serif; background: #f0f2f5; overflow-x: hidden; }
  header { height: var(--header-height); background-color: #ffffff; display: flex; align-items: center; justify-content: space-between; padding: 0 1.5rem; box-shadow: 0 2px 6px rgba(0,0,0,0.1); position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; }
  .menu-title-container { display: flex; align-items: center; gap: 1rem; }
  .menu-icon { display: flex; flex-direction: column; justify-content: space-between; width: 24px; height: 18px; cursor: pointer; }
  .menu-icon span { height: 3px; background-color: #333; border-radius: 2px; transition: all 0.3s; }
  .title { font-size: 1.4rem; font-weight: 600; }
  .header-actions .invite-btn { display: flex; align-items: center; justify-content: center; width: 42px; height: 42px; background-color: #007bff; color: white; border-radius: 50%; text-decoration: none; font-size: 28px; font-weight: 300; line-height: 1; transition: background-color 0.3s; }
  .header-actions .invite-btn:hover { background-color: #0056b3; }
  .sidebar { position: fixed; top: 0; left: 0; width: var(--sidebar-width); height: 100%; background-color: #2c3e50; color: white; padding-top: var(--header-height); transform: translateX(-100%); transition: transform 0.3s ease-in-out; z-index: 900; }
  .sidebar.show { transform: translateX(0); }
  .sidebar nav ul { list-style: none; padding: 20px 0; }
  .sidebar nav li a { display: block; padding: 15px 25px; color: white; text-decoration: none; font-size: 1.1rem; transition: background-color 0.2s; }
  .sidebar nav li a:hover { background-color: #34495e; }
  .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s; z-index: 899; }
  .overlay.show { opacity: 1; visibility: visible; }
  main { padding-top: var(--header-height); height: 100%; width: 100%; display: flex; justify-content: center; align-items: flex-start; overflow-y: auto; }
  table { width: 100%; border-collapse: collapse; table-layout: fixed; background: #fff; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin: 0; }
  caption { height: 8vh; font-size: 3vh; background-color: #4CAF50; color: white; font-weight: bold; line-height: 8vh; }
  th, td { border: 1px solid #ddd; text-align: left; /* 左揃えに変更 */ font-size: 1rem; padding: 8px; vertical-align: top; }
  thead th { height: 6vh; padding: 1vh 0; text-align: center; }
  tbody tr { height: 14vh; }
  td .day-number { font-weight: bold; }
  td.today .day-number { background-color: #ffc107; color: white; border-radius: 50%; width: 28px; height: 28px; display: inline-block; text-align: center; line-height: 28px; }
  td:empty { background-color: #f8f8f8; }
  th:nth-child(1), td:nth-child(1) .day-number { color: #e53935; } /* 日曜 */
  th:nth-child(7), td:nth-child(7) .day-number { color: #1e88e5; } /* 土曜 */
  /* ★★★ 新規追加: 予定表示用スタイル ★★★ */
  .schedules { margin-top: 5px; font-size: 0.8rem; }
  .schedule-item { background-color: #e3f2fd; color: #0d47a1; padding: 3px 5px; border-radius: 3px; margin-bottom: 3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .schedule-time { font-weight: bold; margin-right: 5px; }
</style>
</head>
<body>
  <aside class="sidebar" id="sidebar">
    <nav>
      <ul>
        <li><a href="{{ url_for('calendar') }}">カレンダー</a></li>
        <li><a href="{{ url_for('create') }}">予定の作成</a></li>
        <li><a href="{{ url_for('invite') }}">招待の作成</a></li>
        <li><a href="{{ url_for('logout') }}">ログアウト</a></li>
	<li><a href="{{ url_for('invite_list') }}">招待リスト</a></li>
      </ul>
    </nav>
  </aside>
  <div class="overlay" id="overlay"></div>

  <header>
    <div class="menu-title-container">
      <div class="menu-icon" id="menu-icon"><span></span><span></span><span></span></div>
      <div class="title">スマートイベントプランナー</div>
    </div>
    <div class="header-actions">
        <a href="/invite" class="invite-btn" title="招待を作成">+</a>
    </div>
  </header>

  <main>
    <table>
      <caption>2025年6月</caption>
      <thead>
        <tr>
          <th>日</th><th>月</th><th>火</th><th>水</th><th>木</th><th>金</th><th>土</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td id="day-1"><div class="day-number">1</div><div class="schedules"></div></td>
          <td id="day-2"><div class="day-number">2</div><div class="schedules"></div></td>
          <td id="day-3"><div class="day-number">3</div><div class="schedules"></div></td>
          <td id="day-4"><div class="day-number">4</div><div class="schedules"></div></td>
          <td id="day-5"><div class="day-number">5</div><div class="schedules"></div></td>
          <td id="day-6"><div class="day-number">6</div><div class="schedules"></div></td>
          <td id="day-7"><div class="day-number">7</div><div class="schedules"></div></td>
        </tr>
        <tr>
            <td id="day-8"><div class="day-number">8</div><div class="schedules"></div></td>
            <td id="day-9"><div class="day-number">9</div><div class="schedules"></div></td>
            <td id="day-10"><div class="day-number">10</div><div class="schedules"></div></td>
            <td id="day-11"><div class="day-number">11</div><div class="schedules"></div></td>
            <td id="day-12"><div class="day-number">12</div><div class="schedules"></div></td>
            <td id="day-13"><div class="day-number">13</div><div class="schedules"></div></td>
            <td id="day-14"><div class="day-number">14</div><div class="schedules"></div></td>
        </tr>
        <tr>
            <td id="day-15"><div class="day-number">15</div><div class="schedules"></div></td>
            <td id="day-16"><div class="day-number">16</div><div class="schedules"></div></td>
            <td id="day-17"><div class="day-number">17</div><div class="schedules"></div></td>
            <td id="day-18"><div class="day-number">18</div><div class="schedules"></div></td>
            <td id="day-19"><div class="day-number">19</div><div class="schedules"></div></td>
            <td id="day-20"><div class="day-number">20</div><div class="schedules"></div></td>
            <td id="day-21"><div class="day-number">21</div><div class="schedules"></div></td>
        </tr>
        <tr>
            <td id="day-22"><div class="day-number">22</div><div class="schedules"></div></td>
            <td id="day-23"><div class="day-number">23</div><div class="schedules"></div></td>
            <td id="day-24"><div class="day-number">24</div><div class="schedules"></div></td>
            <td id="day-25" class="today"><div class="day-number">25</div><div class="schedules"></div></td>
            <td id="day-26"><div class="day-number">26</div><div class="schedules"></div></td>
            <td id="day-27"><div class="day-number">27</div><div class="schedules"></div></td>
            <td id="day-28"><div class="day-number">28</div><div class="schedules"></div></td>
        </tr>
        <tr>
            <td id="day-29"><div class="day-number">29</div><div class="schedules"></div></td>
            <td id="day-30"><div class="day-number">30</div><div class="schedules"></div></td>
            <td></td><td></td><td></td><td></td><td></td>
        </tr>
      </tbody>
    </table>
  </main>

  <script>
    // サイドバーの開閉ロジック (変更なし)
    document.addEventListener('DOMContentLoaded', function() {
      const menuIcon = document.getElementById('menu-icon');
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');
      function closeSidebar() {
        sidebar.classList.remove('show');
        overlay.classList.remove('show');
      }
      menuIcon.addEventListener('click', () => {
        sidebar.classList.toggle('show');
        overlay.classList.toggle('show');
      });
      overlay.addEventListener('click', () => closeSidebar());

      // ★★★ 新規追加: Pythonから渡された予定をカレンダーに表示する ★★★
      const schedulesData = {{ schedules | tojson }};
      schedulesData.forEach(schedule => {
        // 日付から日 (day) を取得 (例: "2025-06-25" -> 25)
        const day = new Date(schedule.event_date).getDate();
        const cell = document.getElementById(`day-${day}`);
        if (cell) {
          const scheduleContainer = cell.querySelector('.schedules');
          const scheduleElement = document.createElement('div');
          scheduleElement.classList.add('schedule-item');
          
          let scheduleText = '';
          if (!schedule.is_all_day && schedule.start_time) {
            scheduleText += `<span class="schedule-time">${schedule.start_time}</span>`;
          }
          scheduleText += schedule.title;
          scheduleElement.innerHTML = scheduleText;
          scheduleContainer.appendChild(scheduleElement);
        }
      });
    });
  </script>
</body>
</html>